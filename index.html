<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Iframe Storage Access Test</title>
</head>
<body>
  <h2>Iframe Storage Access Test</h2>
  <button id="checkAccess">Check Storage Access</button>
  <button id="requestAccess">Request Storage Access</button>
  <p id="status"></p>

  <script>
    const status = document.getElementById("status");

    // Check if API is available
    if (document.hasStorageAccess) {
      status.innerText = "requestStorageAccess API is supported.";
    } else {
      status.innerText = "requestStorageAccess API is NOT supported in this browser.";
    }

    // Button to check current access
    document.getElementById("checkAccess").addEventListener("click", async () => {
      if (!document.hasStorageAccess) {
        status.innerText = "API not available.";
        return;
      }

      try {
        const hasAccess = await document.hasStorageAccess();
        status.innerText = hasAccess
          ? "✅ Storage access already granted."
          : "❌ No storage access yet.";
      } catch (err) {
        status.innerText = "Error checking access: " + err;
      }
    });

    // Button to request access
    document.getElementById("requestAccess").addEventListener("click", async () => {
      if (!document.requestStorageAccess) {
        status.innerText = "API not available.";
        return;
      }

      try {
        await document.requestStorageAccess();
        status.innerText = "🎉 Storage access granted!";
      } catch (err) {
        status.innerText = "❌ Access request denied: " + err;
      }
    });
  </script>
</body>
</html>
